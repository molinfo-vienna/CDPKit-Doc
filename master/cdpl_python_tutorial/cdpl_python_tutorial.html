<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Installing the CDPL Python Bindings &mdash; CDPKit 1.3.0.dev1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=361f14d3" />

  
    <link rel="shortcut icon" href="../_static/favicon.svg"/>
    <link rel="canonical" href="https://cdpkit.org/master/cdpl_python_tutorial/cdpl_python_tutorial.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=41a6cf89"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/tabs.js?v=3ee01567"></script>
        <script src="../_static/docs-versions-menu.js?v=bb46260f"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CDPL Python Cookbook" href="../cdpl_python_cookbook/index.html" />
    <link rel="prev" title="CDPL Python Tutorial" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #aaaaaa" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/index.html">Applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CDPL Python Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. Installing the CDPL Python Bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cdpl-package-overview">2. CDPL Package Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-concepts">3. Basic Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-properties">3.1. Dynamic Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#control-parameters">3.2. Control-Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-i-o-framework">3.3. Data I/O Framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-molecules">4. Working with Molecules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#in-memory-representation-of-molecular-structures">4.1. In-memory Representation of Molecular Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-construction-of-molecules">4.2. Manual Construction of Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-molecules">4.3. Reading Molecules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-provided-as-strings">4.3.1. Data provided as Strings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reading-molecules-from-files">4.3.2. Reading Molecules from Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sequential-molecule-reading">4.3.3. Sequential Molecule Reading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#random-molecule-access">4.3.4. Random Molecule Access</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#processing-molecular-graphs">4.4. Processing Molecular Graphs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#accessing-atoms-and-bonds">4.4.1. Accessing Atoms and Bonds</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cdpl_python_cookbook/index.html">CDPL Python Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdpl_api_doc/index.html">CDPL API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #aaaaaa" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CDPKit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">CDPL Python Tutorial</a></li>
      <li class="breadcrumb-item active"><span class="section-number">1. </span>Installing the CDPL Python Bindings</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cdpl_python_tutorial/cdpl_python_tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="installing-the-cdpl-python-bindings">
<h1><span class="section-number">1. </span>Installing the CDPL Python Bindings<a class="headerlink" href="#installing-the-cdpl-python-bindings" title="Link to this heading"></a></h1>
<p>To be able to follow this tutorial the <em>CDPL Python</em> bindings have to be installed on your computer. The most straightforward way to accomplish this task is to install the latest official release deposited on <a class="reference external" href="https://pypi.org/project/CDPKit">PyPI</a> using the <strong class="program">pip</strong> command as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">cdpkit</span>
</pre></div>
</div>
<p>Other ways to install the Python bindings are described in section <a class="reference external" href="https://cdpkit.org/installation.html">Installation</a>.</p>
</section>
<section id="cdpl-package-overview">
<h1><span class="section-number">2. </span>CDPL Package Overview<a class="headerlink" href="#cdpl-package-overview" title="Link to this heading"></a></h1>
<p>The <em>CDPL</em> comprises several sub-packages each providing functionality related to a certain aspect of chem- and pharmacoinformatics. The following table lists all available sub-packages
together with a brief description of the kind of functionality they provide:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Base.html">CDPL.Base</a></p></td>
<td><p>Core classes defining a software framework for functionality implemented in the other <em>CDPL</em> packages</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Util.html">CDPL.Util</a></p></td>
<td><p>Implementations of useful general purpose algorithms, containers, function objects and free functions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Math.html">CDPL.Math</a></p></td>
<td><p>Data structures, algorithms and functions related to mathematics</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html">CDPL.Chem</a></p></td>
<td><p>Infrastructure for the in-memory representation, I/O and basic processing of molecular
structures and reactions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1MolProp.html">CDPL.MolProp</a></p></td>
<td><p>Functionality for the calculation/prediction of physicochemical and topological atom, bond and molecule properties</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Biomol.html">CDPL.Biomol</a></p></td>
<td><p>Functionality for the I/O and processing of biological macromolecules</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Descr.html">CDPL.Descr</a></p></td>
<td><p>Functionality for the generation and processing of pharmacophore and molecule descriptors</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Pharm.html">CDPL.Pharm</a></p></td>
<td><p>Infrastructure for pharmacophore representation, I/O, perception, processing, alignment
and screening</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Shape.html">CDPL.Shape</a></p></td>
<td><p>Infrastructure for Gaussian volume-based molecular shape representation, processing, alignment
and screening</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1ForceField.html">CDPL.ForceField</a></p></td>
<td><p>Implementation of MMFF94(s) for molecule conformer energy calculation and 3D structure optimization</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1ConfGen.html">CDPL.ConfGen</a></p></td>
<td><p>Functionality for molecule 3D structure and conformer ensemble generation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Grid.html">CDPL.Grid</a></p></td>
<td><p>Infrastructure for grid data storage, I/O and processing</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1GRAIL.html">CDPL.GRAIL</a></p></td>
<td><p>Functionality for the generation of GRAIL data sets <span id="id1">[<a class="reference internal" href="../bibliography.html#id21" title="Doris A. Schuetz, Thomas Seidel, Arthur Garon, Riccardo Martini, Markus Körbel, Gerhard F. Ecker, and Thierry Langer. Grail: grids of pharmacophore interaction fields. Journal of Chemical Theory and Computation, 14(9):4958-4970, 2018. PMID: 30075621. URL: https://doi.org/10.1021/acs.jctc.8b00495, arXiv:https://doi.org/10.1021/acs.jctc.8b00495, doi:10.1021/acs.jctc.8b00495.">9</a>]</span> and GRADE
descriptors <span id="id2">[<a class="reference internal" href="../bibliography.html#id4" title="Christian Fellinger, Thomas Seidel, Benjamin Merget, Klaus-Juergen Schleifer, and Thierry Langer. Grade and x-grade: unveiling novel protein–ligand interaction fingerprints based on grail scores. Journal of Chemical Information and Modeling, 0(0):null, 0. PMID: 39980202. URL: https://doi.org/10.1021/acs.jcim.4c01902, arXiv:https://doi.org/10.1021/acs.jcim.4c01902, doi:10.1021/acs.jcim.4c01902.">15</a>]</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Vis.html">CDPL.Vis</a></p></td>
<td><p>Functionality for molecule, reaction and 3D pharmacophore visualization</p></td>
</tr>
</tbody>
</table>
</section>
<section id="basic-concepts">
<h1><span class="section-number">3. </span>Basic Concepts<a class="headerlink" href="#basic-concepts" title="Link to this heading"></a></h1>
<section id="dynamic-properties">
<h2><span class="section-number">3.1. </span>Dynamic Properties<a class="headerlink" href="#dynamic-properties" title="Link to this heading"></a></h2>
<p>The <em>CDPL</em> stores properties associated with certain types of data like molecules, atoms, bonds, pharmacophores, etc. not as ordinary data members of the implementing classes
but as <em>key:value</em> pairs in a dictionary (similar to the <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__dict__">__dict__</a> attribute of Python objects). This design decision was made due to several advantages of this approach:</p>
<ul class="simple">
<li><p>Flexibility and extensibility: new properties can be defined at runtime by user code</p></li>
<li><p>Class instance specific property values can be stored directly in the dictionary of the instance they are
associated with, no external accompanying data structures are required for storing user-defined properties
unknown to the <em>CDPL</em></p></li>
<li><p>It can be easily determined whether the value of a particular property is available or not by checking if
the dictionary contains a corresponding entry. C++ class data members (note that <em>CDPL</em> Python objects just wrap
corresponding C++ class instances!) exist in memory after a class instance has been constructed and from that
point on have a value. This is particularly problematic for properties that cannot be assigned a reasonable
default value.</p></li>
</ul>
<p>All <em>CDPL</em> classes supporting this kind of dynamic property storage are derived from class
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a> which provides methods for property value lookup, storage, removal, iteration, existence testing and counting. Properties are identified by unique keys of type <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1LookupKey.html">CDPL.Base.LookupKey</a>
that are created on-the-fly during the <em>CDPL</em> initialization phase. Keys of pre-defined <em>CDPL</em> properties are exported as static attributes of classes that follow the naming scheme <em>CDPL.&lt;PN&gt;.&lt;CN&gt;Property</em>.
<em>&lt;PN&gt;</em> denotes the <em>CDPL</em> sub-package name (see table above) and <em>&lt;CN&gt;</em> is the name of a child class of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a> for which these
properties have been defined (example: atom property keys accessible via class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomProperty.html">CDPL.Chem.AtomProperty</a>).
Property values virtually can be of any type and get stored in the dictionary as instances of the data wrapper class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1Any.html">CDPL.Base.Any</a>.
Since <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a> methods acting upon a particular property always demand the key of the property as argument and setter/getter methods in addition require knowledge of the value type, corresponding code
is not only tedious to write but also hard to read and error prone. Therefore, each <em>CDPL</em> sub-package that introduces properties also provides four free functions (at package level) per property that encapsulate the
low-level <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a> method calls. These functions internally not only specify the correct property key and value type but also constrain the type of the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a>
subclass the property has been introduced for. <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#a2a3103e8e0338219a5703da063cd3ef5">CDPL.Chem.getOrder()</a>, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#ab4460ac3bac716de49c744c52d980181">CDPL.Chem.setOrder()</a>, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#ad021960310274a588d47cb4f2d25098c">CDPL.Chem.hasOrder()</a> and <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#aedc63dddcd7838a82e1327dec7ca5504">CDPL.Chem.clearOrder()</a> are an example of such four functions that have been provided for the property
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BondProperty.html">CDPL.Chem.BondProperty.ORDER</a> of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Bond.html">CDPL.Chem.Bond</a> instances using integer as value type.</p>
</section>
<section id="control-parameters">
<h2><span class="section-number">3.2. </span>Control-Parameters<a class="headerlink" href="#control-parameters" title="Link to this heading"></a></h2>
<p>Control-parameters are used for the runtime configuration of arbitrary functionality in a generic, flexible and functionality independent way (in the <em>CDPL</em> mainly used by the data I/O and visualization code).
The implementation and usage of the control-parameter infrastructure largely parallels the one for dynamic properties:</p>
<ul class="simple">
<li><p>Control-parameters are identified via unique instances of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1LookupKey.html">CDPL.Base.LookupKey</a></p></li>
<li><p>Values can be of any type and are stored in a dictionary as <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1Any.html">CDPL.Base.Any</a> objects</p></li>
<li><p>Keys of pre-defined control-parameters are exported as static attributes of classes that follow the naming
scheme <em>CDPL.&lt;PN&gt;.ControlParameter</em> (&lt;PN&gt; = <em>CDPL</em> sub-package name, example: <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1ControlParameter.html">CDPL.Chem.ControlParameter</a>)</p></li>
<li><p>Four convenience functions are provided for each control-parameter introduced by a package</p></li>
</ul>
<p><em>CDPL</em> classes employing the control-parameter infrastructure (directly or indirectly) are derived from class
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html">CDPL.Base.ControlParameterContainer</a>. The class provides methods which are similar to those found in
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a> but also offers methods (<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#ac6b8c89fead591acfcdc6d31996a3b84">setParent()</a> and <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#a9d4db56fae26568869b283896b10171a">getParent()</a>) that allow to connect
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html">CDPL.Base.ControlParameterContainer</a> instances in a parent-child manner. This way tree-like hierarchies of
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html">CDPL.Base.ControlParameterContainer</a> instances for resolving parameter value requests can be built.
If a requested parameter value is not stored in a given container, the request gets automatically forwarded to the
registered parent container which may again forward the request to its parent until a value is found or the root of
the tree has been reached. Furthermore, methods are provided which allow the registration of user-defined functions
or function objects that get called on events such as parameter value change (methods
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#a18609f39cfa56248ac4191a1a24740cc">registerParameterChangedCallback()</a> and <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#ac4130ab4db30b557cc3cbe536c747cea">unregisterParameterChangedCallback()</a>), parameter value removal
(methods <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#a59d55eed967a82380c8b2ed2cd40405b">registerParameterRemovedCallback()</a> and <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#a6e8209de7f5cfb7a7b3f94cf109b0156">unregisterParameterRemovedCallback()</a>) and parent change
(methods <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#acf09cf417dfc41787e89825762bb2e32">registerParentChangedCallback()</a> and <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html#aca5b0565223043518608dd7a84cb5e0f">unregisterParentChangedCallback()</a>).</p>
</section>
<section id="data-i-o-framework">
<h2><span class="section-number">3.3. </span>Data I/O Framework<a class="headerlink" href="#data-i-o-framework" title="Link to this heading"></a></h2>
<p>Classes implementing the input/output of data of a certain type in a particular format (e.g. molecular structures in SD-file format) are derived from abstract base classes that follow the naming schemes
<em>CDPL.&lt;PN&gt;.&lt;DT&gt;ReaderBase</em> and  <em>CDPL.&lt;PN&gt;.&lt;DT&gt;WriterBase</em>, respectively. <em>&lt;PN&gt;</em> denotes the <em>CDPL</em> sub-package
name and <em>&lt;DT&gt;</em> is the name of the data type to read or write (e.g. <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">CDPL.Chem.MoleculeReaderBase</a> and
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MolecularGraphWriterBase.html">CDPL.Chem.MolecularGraphWriterBase</a>).
These base classes are all derived from the abstract class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1DataIOBase.html">CDPL.Base.DataIOBase</a> which itself is derived from <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1ControlParameterContainer.html">CDPL.Base.ControlParameterContainer</a>. Instances of concrete classes implementing a particular data I/O format
thus support the configuration of their runtime behavior by control-parameters (see <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1ControlParameter.html">CDPL.Chem.ControlParameter</a>
for examples). The name of classes implementing the input/output of data in one of the supported formats all follow the scheme <em>CDPL.&lt;PN&gt;.&lt;FID&gt;&lt;DT&gt;Reader</em> and <em>CDPL.&lt;PN&gt;.&lt;FID&gt;&lt;DT&gt;Writer</em>, respectively where <em>&lt;PN&gt;</em> denotes the
<em>CDPL</em> sub-package name, <em>&lt;FID&gt;</em> is a format identifier (usually a characteristic file extension) and <em>&lt;DT&gt;</em> is
the name of the data type to read or write (e.g. <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1SDFMoleculeReader.html">CDPL.Chem.SDFMoleculeReader</a> and
<a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1SDFMolecularGraphWriter.html">CDPL.Chem.SDFMolecularGraphWriter</a>).
These classes all expect an instance of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1IOStream.html">CDPL.Base.IOStream</a> as constructor argument which abstracts the type of data source/sink to read from or write to. Subclasses of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1IOStream.html">CDPL.Base.IOStream</a> are provided that implement a particular type of storage such as files (class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1FileIOStream.html">CDPL.Base.FileIOStream</a>) and in-memory strings (class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1StringIOStream.html">CDPL.Base.StringIOStream</a>).</p>
<p>Each data format implemented by the <em>CDPL</em> is described by an instance of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1DataFormat.html">CDPL.Base.DataFormat</a> which
stores and gives access to relevant format-specific information such common file-extensions or mime-type.
Pre-defined data format descriptors are exported as static attributes of classes following the naming scheme
<em>CDPL.&lt;PN&gt;.DataFormat</em> where <em>&lt;PN&gt;</em> is the name of the <em>CDPL</em> sub-package implementing the format (e.g. <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1DataFormat.html">CDPL.Chem.DataFormat</a>).</p>
<p><strong>TODO</strong></p>
</section>
</section>
<section id="working-with-molecules">
<h1><span class="section-number">4. </span>Working with Molecules<a class="headerlink" href="#working-with-molecules" title="Link to this heading"></a></h1>
<section id="in-memory-representation-of-molecular-structures">
<h2><span class="section-number">4.1. </span>In-memory Representation of Molecular Structures<a class="headerlink" href="#in-memory-representation-of-molecular-structures" title="Link to this heading"></a></h2>
<p>The <em>CDPL</em> models molecular structures as undirected graphs where atoms represent the graph nodes and bonds the edges. Concrete data structures for the in-memory representation of atoms,
bonds and molecular graphs implement a hierarchy of interfaces (abstract classes) that specify all necessary methods for common operations like atom/bond addition, removal, access, membership testing, counting, and so on.</p>
<p>The following table provides an overview of the most relevant interfaces and data structures provided by the <em>CDPL</em> for molecular data representation and processing:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17.2%" />
<col style="width: 13.8%" />
<col style="width: 34.5%" />
<col style="width: 34.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class Name</p></th>
<th class="head"><p>Class Type</p></th>
<th class="head"><p>Parent Class(es)</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Entity3D.html">CDPL.Chem.Entity3D</a></p></td>
<td><p>Interface</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a></p></td>
<td><p>Represents an arbitrary entity that can have a position in 3D space</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Entity3DContainer.html">CDPL.Chem.Entity3DContainer</a></p></td>
<td><p>Interface</p></td>
<td><p>None</p></td>
<td><p>Represents a collection of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Entity3D.html">CDPL.Chem.Entity3D</a> instances and specifies methods for read-only
instance access and querying their number</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html">CDPL.Chem.AtomContainer</a></p></td>
<td><p>Interface</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Entity3DContainer.html">CDPL.Chem.Entity3DContainer</a></p></td>
<td><p>Represents a collection of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Atom.html">CDPL.Chem.Atom</a> instances and specifies methods for read-only
instance access, querying their number and collection membership testing</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BondContainer.html">CDPL.Chem.BondContainer</a></p></td>
<td><p>Interface</p></td>
<td><p>None</p></td>
<td><p>Represents a collection of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Bond.html">CDPL.Chem.Bond</a> instances and specifies methods for read-only
instance access, querying their number and collection membership testing</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Atom.html">CDPL.Chem.Atom</a></p></td>
<td><p>Interface</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Entity3D.html">CDPL.Chem.Entity3D</a>, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html">CDPL.Chem.AtomContainer</a>, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BondContainer.html">CDPL.Chem.BondContainer</a></p></td>
<td><p>Represents an atom in molecular structures/graphs and provides additional connectivity
and ownership related methods</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicAtom.html">CDPL.Chem.BasicAtom</a></p></td>
<td><p>Implementation</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Atom.html">CDPL.Chem.Atom</a></p></td>
<td><p>Default implementation of the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Atom.html">CDPL.Chem.Atom</a> interface</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Bond.html">CDPL.Chem.Bond</a></p></td>
<td><p>Interface</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html">CDPL.Chem.AtomContainer</a>, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a></p></td>
<td><p>Represents a bond connecting two atoms in molecular structures/graphs, specifies additional connectivity
and ownership related methods</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicBond.html">CDPL.Chem.BasicBond</a></p></td>
<td><p>Implementation</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Bond.html">CDPL.Chem.Bond</a></p></td>
<td><p>Default implementation of the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Bond.html">CDPL.Chem.Bond</a> interface</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MolecularGraph.html">CDPL.Chem.MolecularGraph</a></p></td>
<td><p>Interface</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html">CDPL.Chem.AtomContainer</a>, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BondContainer.html">CDPL.Chem.BondContainer</a>, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1PropertyContainer.html">CDPL.Base.PropertyContainer</a></p></td>
<td><p>Represents an arbitrary molecular graph described by a list of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Atom.html">CDPL.Chem.Atom</a> and a list of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Bond.html">CDPL.Chem.Bond</a> instances,
specifies additional methods for cloning and atom/bond sequence reordering</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Molecule.html">CDPL.Chem.Molecule</a></p></td>
<td><p>Interface</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MolecularGraph.html">CDPL.Chem.MolecularGraph</a></p></td>
<td><p>Extends the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MolecularGraph.html">CDPL.Chem.MolecularGraph</a> interface by methods for atom and bond creation as well as methods for
merging with other molecular graphs</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicMolecule.html">CDPL.Chem.BasicMolecule</a></p></td>
<td><p>Implementation</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Molecule.html">CDPL.Chem.Molecule</a></p></td>
<td><p>Default implementation of the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Molecule.html">CDPL.Chem.Molecule</a> interface</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Fragment.html">CDPL.Chem.Fragment</a></p></td>
<td><p>Interface</p></td>
<td><p><a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MolecularGraph.html">CDPL.Chem.MolecularGraph</a></p></td>
<td><p>Stores references (not copies!) to <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Atom.html">CDPL.Chem.Atom</a> and <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Bond.html">CDPL.Chem.Bond</a> objects owned/managed by one or
more <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Molecule.html">CDPL.Chem.Molecule</a> instances and thus allows to specify molecule
substructures/fragments of any kind (e.g. rings, substructure matches, …) in a memory-efficient manner</p></td>
</tr>
</tbody>
</table>
<p>Most of the classes listed above as well as other classes/functions used for molecular data I/O and basic processing reside in package <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html">CDPL.Chem</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">CDPL.Chem</span> <span class="k">as</span> <span class="nn">Chem</span>
</pre></div>
</div>
<p>By the import line above the code in the remainder of this tutorial can conveniently access all package contents via the prefix <em>Chem.*</em>.</p>
<p>Furthermore, the <em>CDPL Python</em> bindings implement the <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/plotting.html">Rich Output</a> of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MolecularGraph.html">Chem.MolecularGraph</a> instances in Jupyter notebooks. Rich output is activated by importing the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Vis.html">CDPL.Vis</a> package and will be used in the following code snippets to display the skeletal formula of molecular graphs simply by typing the variable name at
the end of a code cell.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">CDPL.Vis</span>
</pre></div>
</div>
</section>
<section id="manual-construction-of-molecules">
<h2><span class="section-number">4.2. </span>Manual Construction of Molecules<a class="headerlink" href="#manual-construction-of-molecules" title="Link to this heading"></a></h2>
<p>An initally empty molecule object without any atoms and bonds can then be created as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">BasicMolecule</span><span class="p">()</span>
</pre></div>
</div>
<p>The number of (explicit) atoms can be queried either by acessing the property <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html">numAtoms</a> or by calling the method <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html#aa18ef7240d27820c882998d8c8dbdfd7">getNumAtoms()</a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">numAtoms</span>
<span class="c1"># or</span>
<span class="c1">#mol.getNumAtoms()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
</pre></div>
</div>
<p>In the same manner, the number of bonds can be retrieved by:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">numBonds</span>
<span class="c1"># or</span>
<span class="c1">#mol.getNumBonds()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
</pre></div>
</div>
<p>Atoms are created by calling the method <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Molecule.html#ab998b55e7f56b00f47e3acbfa4511f2e">addAtom()</a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">addAtom</span><span class="p">()</span>
</pre></div>
</div>
<p>The method returns a <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicAtom.html">Chem.BasicAtom</a> object which is owned by the creating <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicMolecule.html">Chem.BasicMolecule</a> instance <em>mol*</em>. The created atom does not yet possess any chemical properties like element, formal charge, and so on. The values of these properties need to be set explicitly by invoking dedicated property functions which take the atom and desired value of the property as arguments. For example</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AtomType</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#a6b7bd15a77897e642d44ec56395db91f">Chem.setType()</a> function will set the type property of the atom to the atomic number of carbon. The value of the type property can be retrieved by the associated function <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#a2ab1b85967b8f213bced1ac9b9dcbd6b">Chem.getType()</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">6</span>
</pre></div>
</div>
<p>In a similar fashion, bonds are created by calling the method <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1Molecule.html#acd42f15d874185b4eea2cf497a509ea6">addBond()</a> which expects the indices (zero-based) of the two atoms to connect as arguments:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add second carbon atom</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addAtom</span><span class="p">(),</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AtomType</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">addBond</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The method returns a <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicBond.html">Chem.BasicBond</a> object which is also owned by the creating <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicMolecule.html">Chem.BasicMolecule</a> instance <em>mol</em>. As with atoms, the created bond does not yet have any properties. To set the bond order to a value of 2 (= double bond) the property function <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#ab4460ac3bac716de49c744c52d980181">Chem.setOrder()</a> needs to be called:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>A previously set bond order property value can be accessed by the accompanying getter function <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#a2a3103e8e0338219a5703da063cd3ef5">Chem.getOrder()</a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">getOrder</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span>
</pre></div>
</div>
<img alt="../_images/cdpl_python_tutorial_25_0.svg" src="../_images/cdpl_python_tutorial_25_0.svg" />
<p>To create a more complex molecule, e.g. Pyridine, from the Ethene fragment that is currently described by <strong>mol</strong> the following lines will do the trick:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create missing atoms and set atom types</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addAtom</span><span class="p">(),</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AtomType</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addAtom</span><span class="p">(),</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AtomType</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addAtom</span><span class="p">(),</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AtomType</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addAtom</span><span class="p">(),</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AtomType</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># create missing bonds and set orders</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addBond</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addBond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addBond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addBond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">addBond</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">numBonds</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">6</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">numAtoms</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">6</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span>
</pre></div>
</div>
<img alt="../_images/cdpl_python_tutorial_30_0.svg" src="../_images/cdpl_python_tutorial_30_0.svg" />
</section>
<section id="reading-molecules">
<h2><span class="section-number">4.3. </span>Reading Molecules<a class="headerlink" href="#reading-molecules" title="Link to this heading"></a></h2>
<section id="data-provided-as-strings">
<h3><span class="section-number">4.3.1. </span>Data provided as Strings<a class="headerlink" href="#data-provided-as-strings" title="Link to this heading"></a></h3>
<p class="rubric">SMILES and SMARTS</p>
<p>For the direct parsing of SMILES strings the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html">CDPL.Chem</a> package provides the built-in utility function <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#a97463a5b3b08debaa2b2299a2644e912">Chem.parseSMILES()</a>. The function returns a <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicMolecule.html">Chem.BasicMolecule</a> object representing the chemical structure
encoded by the given SMILES string. For example:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">parseSMILES</span><span class="p">(</span><span class="s1">&#39;c1c(C(=O)O)ccc(CNN)c1&#39;</span><span class="p">)</span>

<span class="n">mol</span>
</pre></div>
</div>
<img alt="../_images/cdpl_python_tutorial_32_0.svg" src="../_images/cdpl_python_tutorial_32_0.svg" />
<p>A similar function called <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/namespaceCDPL_1_1Chem.html#a5248eaa483ae5dc078a8f276c91ed5dc">Chem.parseSMARTS()</a> can be used to parse and and prepare SMARTS patterns for substructure searching:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">parseSMARTS</span><span class="p">(</span><span class="s1">&#39;c1:c:[n,o,s]:c:c:1-[C:2](-,=[*])-,=O&#39;</span><span class="p">)</span>

<span class="n">mol</span>
</pre></div>
</div>
<img alt="../_images/cdpl_python_tutorial_34_0.svg" src="../_images/cdpl_python_tutorial_34_0.svg" />
<p class="rubric">Other formats</p>
<p>The general procedure for reading molecules from string data in one of the supported input formats (including SMILES and SMARTS) is as follows:</p>
<ol class="arabic simple">
<li><p>Create an instance of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1StringIOStream.html">Base.StringIOStream</a> that wraps the string and serves as input data source for the next steps.</p></li>
<li><p>Create a suitable <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">Chem.MoleculeReaderBase</a> subclass instance that will perform the format-specific decoding of the molecule data in step 3.</p></li>
<li><p>Call the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html#a07056e4d2a6de5045d59f2356d3d5521">read()</a> method of the created data reader providing an instance of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicMolecule.html">Chem.BasicMolecule</a> for the storage of the read molecular structure as argument.</p></li>
</ol>
<p>Molecule data readers for a specific format (Step 2) can be created in two ways:</p>
<ol class="arabic simple">
<li><p>Via class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReader.html">Chem.MoleculeReader</a> providing the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1StringIOStream.html">Base.StringIOStream</a> instance (Step 1) and a data format specifier (= file extension or one of the data format descriptors defined in class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1DataFormat.html">Chem.DataFormat</a>) as constructor arguments.</p></li>
<li><p>Direct instantiation of a format-specific subclass of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">Chem.MoleculeReaderBase</a> (e.g. Chem.MOL2MoleculeReader`_ implementing the Sybyl MOL2 format input).</p></li>
</ol>
<p>Example: Reading a molecule from a string providing data in MDL SDF format</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">CDPL.Base</span> <span class="k">as</span> <span class="nn">Base</span>

<span class="n">sdf_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;5950</span>
<span class="s2">          12162506342D</span>

<span class="s2"> 13 12  0     1  0  0  0  0  0999 V2000</span>
<span class="s2">    5.1350   -0.2500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    4.2690    1.2500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    2.5369    0.2500    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    3.4030   -0.2500    0.0000 C   0  0  1  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    3.4030   -1.2500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    4.2690    0.2500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    3.4030    0.3700    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    2.7830   -1.2500    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    3.4030   -1.8700    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    4.0230   -1.2500    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    2.0000   -0.0600    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    2.5369    0.8700    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">    5.6720    0.0600    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="s2">  1  6  1  0  0  0  0</span>
<span class="s2">  1 13  1  0  0  0  0</span>
<span class="s2">  2  6  2  0  0  0  0</span>
<span class="s2">  4  3  1  6  0  0  0</span>
<span class="s2">  3 11  1  0  0  0  0</span>
<span class="s2">  3 12  1  0  0  0  0</span>
<span class="s2">  4  5  1  0  0  0  0</span>
<span class="s2">  4  6  1  0  0  0  0</span>
<span class="s2">  4  7  1  0  0  0  0</span>
<span class="s2">  5  8  1  0  0  0  0</span>
<span class="s2">  5  9  1  0  0  0  0</span>
<span class="s2">  5 10  1  0  0  0  0</span>
<span class="s2">M  END</span>
<span class="s2">&gt; &lt;PUBCHEM_COMPOUND_CID&gt;</span>
<span class="s2">5950</span>

<span class="s2">$$$$</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">ios</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">StringIOStream</span><span class="p">(</span><span class="n">sdf_data</span><span class="p">)</span>

<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="n">ios</span><span class="p">,</span> <span class="s1">&#39;sdf&#39;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="c1">#reader = Chem.MoleculeReader(ios, Chem.DataFormat.SDF)</span>
<span class="c1"># or</span>
<span class="c1">#reader = Chem.SDFMoleculeReader(ios)</span>

<span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mol</span>
</pre></div>
</div>
<img alt="../_images/cdpl_python_tutorial_36_0.svg" src="../_images/cdpl_python_tutorial_36_0.svg" />
</section>
<section id="reading-molecules-from-files">
<h3><span class="section-number">4.3.2. </span>Reading Molecules from Files<a class="headerlink" href="#reading-molecules-from-files" title="Link to this heading"></a></h3>
<p>Reading molecules from files also requires the creation of a <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">Chem.MoleculeReaderBase</a> subclass instance that performs the actual format-specific data decoding work. As with string data, several options exist:</p>
<ol class="arabic simple">
<li><p>Instantiation of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReader.html">Chem.MoleculeReader</a> passing the path to the file as constructor argument. When just a path is provided as argument then the data format will be determined automatically from the file extension. To override this behavior, a second argument specifying the actual file extension string to use (e.g. sdf, smi, mol2, ..) or one one of the data format descriptors defined in class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1DataFormat.html">Chem.DataFormat</a> has to be provided.</p></li>
<li><p>Instantiation of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReader.html">Chem.MoleculeReader</a> passing an instance of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1FileIOStream.html">Base.FileIOStream</a> that was created for the file as the first and and a format specifier as the second argument. The format specification can be a characteristic file extension or one of the data format descriptors defined in class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1DataFormat.html">Chem.DataFormat</a>.</p></li>
<li><p>Direct instantiation of a format-specific subclass of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">Chem.MoleculeReaderBase</a> (e.g. <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1SDFMoleculeReader.html">Chem.SDFMoleculeReader</a> implementing reading MDL SD-file format data) that accepts an instance of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Base_1_1FileIOStream.html">Base.FileIOStream</a> as constructor argument.</p></li>
<li><p>Direct instantiation of a format-specific subclass of <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">Chem.MoleculeReaderBase</a> (e.g. <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1FileSDFMoleculeReader.html">Chem.FileSDFMoleculeReader</a>) that accepts a file path as constructor argument.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># - Option 1 -</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="s1">&#39;/path/to/input/file.sdf&#39;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="s1">&#39;/path/to/input/file&#39;</span><span class="p">,</span> <span class="s1">&#39;smi&#39;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="s1">&#39;/path/to/input/file&#39;</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">DataFormat</span><span class="o">.</span><span class="n">SMILES</span><span class="p">)</span>

<span class="c1"># - Option 2 -</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">FileIOStream</span><span class="p">(</span><span class="s1">&#39;/path/to/input/file&#39;</span><span class="p">),</span> <span class="s1">&#39;sdf&#39;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">FileIOStream</span><span class="p">(</span><span class="s1">&#39;/path/to/input/file&#39;</span><span class="p">),</span> <span class="n">Chem</span><span class="o">.</span><span class="n">DataFormat</span><span class="o">.</span><span class="n">SDF</span><span class="p">)</span>

<span class="c1"># - Option 3 -</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MOL2MoleculeReader</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">FileIOStream</span><span class="p">(</span><span class="s1">&#39;/path/to/input/file&#39;</span><span class="p">))</span>

<span class="c1"># - Option 4 -</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">FileSDFMoleculeReader</span><span class="p">(</span><span class="s1">&#39;/path/to/input/file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sequential-molecule-reading">
<h3><span class="section-number">4.3.3. </span>Sequential Molecule Reading<a class="headerlink" href="#sequential-molecule-reading" title="Link to this heading"></a></h3>
<p>Given a properly initialized <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">Chem.MoleculeReaderBase</a> subclass instance, molecules can be read in the order provided by the input data by repeatedly calling the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html#a07056e4d2a6de5045d59f2356d3d5521">read()</a> method. If there are no more molecules to read, the return value of the method will evaluate to <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smi_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;c1n(ccn1)c1ccc(cc1)c1ccc(n1c1c(cc(cc1)C(=O)N)C)CCC(=O)[O-] 022_3QJ5_A</span>
<span class="s2">CNC(=O)[C@H](C(C)(C)C)NC(=O)[C@@H]([C@H](C)N([O-])C=O)CCCc1ccccc1 023_2WO9_B</span>
<span class="s2">N1N(C(c2c(C=1Nc1cc([nH]n1)C)ccc(N1CC[NH+](CC1)C)c2)=O)C(C)C 027_3PIX_A</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">ios</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">StringIOStream</span><span class="p">(</span><span class="n">smi_data</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="n">ios</span><span class="p">,</span> <span class="s1">&#39;smi&#39;</span><span class="p">)</span>
<span class="n">mol_count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
   <span class="n">mol_count</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Read </span><span class="si">{</span><span class="n">mol_count</span><span class="si">}</span><span class="s1"> molecules&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="mi">3</span> <span class="n">molecules</span>
</pre></div>
</div>
</section>
<section id="random-molecule-access">
<h3><span class="section-number">4.3.4. </span>Random Molecule Access<a class="headerlink" href="#random-molecule-access" title="Link to this heading"></a></h3>
<p>There is a special version of the <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html#a07056e4d2a6de5045d59f2356d3d5521">read()</a> method of class <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">Chem.MoleculeReaderBase</a> which expects the index (zero-based) of the molecule to read as its first argument. This way molecules can be read in any order, no matter what their order is in the input data. The number of available molecules can be queried either by calling the method <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html#aedf59cb63964cb6d497d251acddd4c80">getNumRecords()</a> or by accessing the property <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1MoleculeReaderBase.html">numRecords</a>.</p>
<p>Example:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ios</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">StringIOStream</span><span class="p">(</span><span class="n">smi_data</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MoleculeReader</span><span class="p">(</span><span class="n">ios</span><span class="p">,</span> <span class="s1">&#39;smi&#39;</span><span class="p">)</span>

<span class="n">num_mols</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">getNumRecords</span><span class="p">()</span>
<span class="c1"># or</span>
<span class="c1">#num_mols = reader.numRecords</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of input molecules: </span><span class="si">{</span><span class="n">num_mols</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="nb">input</span> <span class="n">molecules</span><span class="p">:</span> <span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the 2nd molecule</span>
<span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

<span class="n">mol</span>
</pre></div>
</div>
<img alt="../_images/cdpl_python_tutorial_43_0.svg" src="../_images/cdpl_python_tutorial_43_0.svg" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the 1st molecule</span>
<span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>

<span class="n">mol</span>
</pre></div>
</div>
<img alt="../_images/cdpl_python_tutorial_44_0.svg" src="../_images/cdpl_python_tutorial_44_0.svg" />
<p>If the index is out of the valid range then a corresponding exception will be thrown:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># there is no 4th molecule</span>
<span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">IndexError</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
      <span class="mi">1</span> <span class="c1"># there is no 4th molecule</span>
<span class="o">----&gt;</span> <span class="mi">2</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">mol</span><span class="p">)</span>


<span class="ne">IndexError</span><span class="p">:</span> <span class="n">StreamDataReader</span><span class="p">:</span> <span class="n">record</span> <span class="n">index</span> <span class="n">out</span> <span class="n">of</span> <span class="n">bounds</span>
</pre></div>
</div>
</section>
</section>
<section id="processing-molecular-graphs">
<h2><span class="section-number">4.4. </span>Processing Molecular Graphs<a class="headerlink" href="#processing-molecular-graphs" title="Link to this heading"></a></h2>
<section id="accessing-atoms-and-bonds">
<h3><span class="section-number">4.4.1. </span>Accessing Atoms and Bonds<a class="headerlink" href="#accessing-atoms-and-bonds" title="Link to this heading"></a></h3>
<p>Atom and bonds of a molecular graph represented by, e. g., a <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BasicMolecule.html">Chem.BasicMolecule</a> instance can be accessed by calling the methods <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html#ae4dc0c96b4675cdd0726a6a0a55c681f">getAtom()</a> and <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BondContainer.html#aad68f03787b42d08b22bfc820e5016a6">getBond()</a>, respectively. These methods expect the zero-based index of the atom/bond in the parent molecular graphs’s atom/bond list as argument. Allowed atom/bond indices are in the range [0, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1AtomContainer.html#aa18ef7240d27820c882998d8c8dbdfd7">getNumAtoms()</a>)/[0, <a class="reference external" href="https://cdpkit.org/cdpl_api_doc/python_api_doc/classCDPL_1_1Chem_1_1BondContainer.html#ae0aa42f2445494d5e0bf3e3019545236">getNumBonds()</a>). Providing an index outside the allowed range will result in an exception.</p>
<p>Example: Counting element symbols and bond orders</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym_counts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">order_counts</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">numAtoms</span><span class="p">):</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">getAtom</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">sym</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">getSymbol</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">sym_counts</span><span class="p">:</span>
        <span class="n">sym_counts</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sym_counts</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">numBonds</span><span class="p">):</span>
    <span class="n">bond</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">getBond</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">getOrder</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">order_counts</span><span class="p">:</span>
        <span class="n">order_counts</span><span class="p">[</span><span class="n">order</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_counts</span><span class="p">[</span><span class="n">order</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Element symbols: </span><span class="si">{</span><span class="n">sym_counts</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Bond orders: </span><span class="si">{</span><span class="n">order_counts</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Element</span> <span class="n">symbols</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">Bond</span> <span class="n">orders</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="CDPL Python Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../cdpl_python_cookbook/index.html" class="btn btn-neutral float-right" title="CDPL Python Cookbook" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Thomas Seidel and Oliver Wieder.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>